using System.Management.Automation;
using System.Diagnostics;
using System.Reflection.PortableExecutable;
using Microsoft.AspNetCore.Mvc;
using Microsoft.EntityFrameworkCore;
using PowershellShowcase;


namespace backend.Controllers;

[ApiController]
[Route("/script")]

public class PowerShellScriptController : ControllerBase

    {
    
        [HttpGet("{id}")]
        public string Get(string id)
        {
			string z="Get-Aduser -identity internpn";
         using (PowerShell powershell = PowerShell.Create().AddScript(@"import-module ActiveDirectory").AddScript(z))
            {

                foreach (PSObject result in powershell.Invoke())
                {
                    return result.Members["DistinguishedName"].Value.ToString();
				
                }
				
            }
			return PowerShellHandler.Command("$PSversionTable");


 
       
    }



}

   




